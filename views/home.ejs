<!DOCTYPE html>
<html lang="en">

<head>

  <% include ../partials/head.ejs %>

  <style>

    #prof_pic img {
        box-shadow: 0px 10px 40px #000;
    }

  </style>


</head>

<body>
	<div class="preloader">
		<img src="/img/loader.gif" alt="Preloader image">
	</div>

  <% include ../partials/nav.ejs %>

	<header id="intro">
		<div class="container">
			<div class="table">
				<div class="header-text">
					<div class="row">
						<div class="col-md-12 text-center">
							<h1 class="white typed">Judge My Educator.</h1>
							<span class="typed-cursor">|</span>
							<h3 class="light white" id="subheader">Let us tell you who the best professor is for you.</h3>
            	<h3 class="light white" id="tester"></h3>
							<div class="form-group">
						    <input class="form-control input-sm" id="inputsm" list="json-datalist" type="text" placeholder = "Enter Professor &amp; School Here - Then Press ENTER">
                <datalist id="json-datalist">

                </datalist>
              </div>
						</div>
					</div>
				</div>
			</div>
		</div>
	</header>

	<section id="services" class="section section-padded">
		<div class="container">
			<div class="row text-center title">
        <span id = "prof_pic"></span>
        <hr>
				<h2 id="prof_name"></h2>
				<h3 class="light muted"><span id ="overall_rating"><a href="#intro">Click Here To Search For A Professor</a></span></h3>
        <h4 class="light muted"><b></b></h4>
			</div>
			<div class="row services">
				<div class="col-md-4">
					<div class="service">
						<div class="icon-holder">
							<img src="/img/icons/helpfulness.png" alt="" class="icon">
						</div>
						<h4 class="heading">Helpfulness<hr><span id="helpfulness_rating">Search For A Prof To See Rating</span></h4>
						<p class="description"><span id="helpfulness_descr"><a href="#intro">Click Here To Search For A Professor</a></span></p>
					</div>
				</div>
				<div class="col-md-4">
					<div class="service">
						<div class="icon-holder">
							<img src="/img/icons/clarity.png" alt="" class="icon">
						</div>
						<h4 class="heading">Clarity<hr><span id="clarity_rating">Search For A Prof To See Rating</span></h4>
						<p class="description"><span id="clarity_descr"><a href="#intro">Click Here To Search For A Professor</a></span></p>
					</div>
				</div>
				<div class="col-md-4">
					<div class="service">
						<div class="icon-holder">
							<img src="/img/icons/easiness.png" alt="" class="icon">
						</div>
						<h4 class="heading">Easiness<hr><span id="easiness_rating">Search For A Prof To See Rating</span></h4>
						<p class="description"><span id="easiness_descr"><a href="#intro">Click Here To Search For A Professor</a></span></p>
					</div>
				</div>
			</div>
		</div>
		<div class="cut cut-bottom"></div>
	</section>
	<section id="team" class="section gray-bg">
		<div class="container">
			<div class="row title text-center">
				<h2 class="margin-top">Team</h2>
				<h4 class="light muted">We're a dream team!</h4>
			</div>
			<div class="row">
				<div class="col-md-4">
					<div class="team text-center">
						<div class="cover" style="background:url('img/team/team-cover1.jpg'); background-size:cover;">
							<div class="overlay text-center">
								<h3 class="white">$69.00</h3>
								<h5 class="light light-white">1 - 5 sessions / month</h5>
							</div>
						</div>
						<img src="/img/team/team3.jpg" alt="Team Image" class="avatar">
						<div class="title">
							<h4>Ben Adamson</h4>
							<h5 class="muted regular">Fitness Instructor</h5>
						</div>
						<button data-toggle="modal" data-target="#modal1" class="btn btn-blue-fill">Sign Up Now</button>
					</div>
				</div>
				<div class="col-md-4">
					<div class="team text-center">
						<div class="cover" style="background:url('img/team/team-cover2.jpg'); background-size:cover;">
							<div class="overlay text-center">
								<h3 class="white">$69.00</h3>
								<h5 class="light light-white">1 - 5 sessions / month</h5>
							</div>
						</div>
						<img src="/img/team/team1.jpg" alt="Team Image" class="avatar">
						<div class="title">
							<h4>Eva Williams</h4>
							<h5 class="muted regular">Personal Trainer</h5>
						</div>
						<a href="#" data-toggle="modal" data-target="#modal1" class="btn btn-blue-fill ripple">Sign Up Now</a>
					</div>
				</div>
				<div class="col-md-4">
					<div class="team text-center">
						<div class="cover" style="background:url('img/team/team-cover3.jpg'); background-size:cover;">
							<div class="overlay text-center">
								<h3 class="white">$69.00</h3>
								<h5 class="light light-white">1 - 5 sessions / month</h5>
							</div>
						</div>
						<img src="/img/team/team2.jpg" alt="Team Image" class="avatar">
						<div class="title">
							<h4>John Phillips</h4>
							<h5 class="muted regular">Personal Trainer</h5>
						</div>
						<a href="#" data-toggle="modal" data-target="#modal1" class="btn btn-blue-fill ripple">Sign Up Now</a>
					</div>
				</div>
			</div>
		</div>
	</section>
	<section id="pricing" class="section">
		<div class="container">
			<div class="row title text-center">
				<h2 class="margin-top white">Pricing</h2>
				<h4 class="light white">Choose your favorite pricing plan and sign up today!</h4>
			</div>
			<div class="row no-margin">
				<div class="col-md-7 no-padding col-md-offset-5 pricings text-center">
					<div class="pricing">
						<div class="box-main active" data-img="img/pricing1.jpg">
							<h4 class="white">Yoga Pilates</h4>
							<h4 class="white regular light">$850.00 <span class="small-font">/ year</span></h4>
							<a href="#" data-toggle="modal" data-target="#modal1" class="btn btn-white-fill">Sign Up Now</a>
							<i class="info-icon icon_question"></i>
						</div>
						<div class="box-second active">
							<ul class="white-list text-left">
								<li>One Personal Trainer</li>
								<li>Big gym space for training</li>
								<li>Free tools &amp; props</li>
								<li>Free locker</li>
								<li>Free before / after shower</li>
							</ul>
						</div>
					</div>
					<div class="pricing">
						<div class="box-main" data-img="img/pricing2.jpg">
							<h4 class="white">Cardio Training</h4>
							<h4 class="white regular light">$100.00 <span class="small-font">/ year</span></h4>
							<a href="#" data-toggle="modal" data-target="#modal1" class="btn btn-white-fill">Sign Up Now</a>
							<i class="info-icon icon_question"></i>
						</div>
						<div class="box-second">
							<ul class="white-list text-left">
								<li>One Personal Trainer</li>
								<li>Big gym space for training</li>
								<li>Free tools &amp; props</li>
								<li>Free locker</li>
								<li>Free before / after shower</li>
							</ul>
						</div>
					</div>
				</div>
			</div>
		</div>
	</section>
	<section class="section section-padded blue-bg">
		<div class="container">
			<div class="row">
				<div class="col-md-8 col-md-offset-2">
					<div class="owl-twitter owl-carousel">
						<div class="item text-center">
							<i class="icon fa fa-twitter"></i>
							<h4 class="white light">To enjoy the glow of good health, you must exercise.</h4>
							<h4 class="light-white light">#health #training #exercise</h4>
						</div>
						<div class="item text-center">
							<i class="icon fa fa-twitter"></i>
							<h4 class="white light">To enjoy the glow of good health, you must exercise.</h4>
							<h4 class="light-white light">#health #training #exercise</h4>
						</div>
						<div class="item text-center">
							<i class="icon fa fa-twitter"></i>
							<h4 class="white light">To enjoy the glow of good health, you must exercise.</h4>
							<h4 class="light-white light">#health #training #exercise</h4>
						</div>
					</div>
				</div>
			</div>
		</div>
	</section>
	<div class="modal fade" id="modal1" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
		<div class="modal-dialog">
			<div class="modal-content modal-popup">
				<a href="#" class="close-link"><i class="icon_close_alt2"></i></a>
				<h3 class="white">Sign Up</h3>
				<form action="" class="popup-form">
					<input type="text" class="form-control form-white" placeholder="Full Name">
					<input type="text" class="form-control form-white" placeholder="Email Address">
					<div class="dropdown">
						<button id="dLabel" class="form-control form-white dropdown" type="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
							Pricing Plan
						</button>
						<ul class="dropdown-menu animated fadeIn" role="menu" aria-labelledby="dLabel">
							<li class="animated lightSpeedIn"><a href="#">1 month membership ($150)</a></li>
							<li class="animated lightSpeedIn"><a href="#">3 month membership ($350)</a></li>
							<li class="animated lightSpeedIn"><a href="#">1 year membership ($1000)</a></li>
							<li class="animated lightSpeedIn"><a href="#">Free trial class</a></li>
						</ul>
					</div>
					<div class="checkbox-holder text-left">
						<div class="checkbox">
							<input type="checkbox" value="None" id="squaredOne" name="check" />
							<label for="squaredOne"><span>I Agree to the <strong>Terms &amp; Conditions</strong></span></label>
						</div>
					</div>
					<button type="submit" class="btn btn-submit">Submit</button>
				</form>
			</div>
		</div>
	</div>
	<footer>
		<div class="container">
			<div class="row">
				<div class="col-sm-6 text-center-mobile">
					<h3 class="white">Reserve a Free Trial Class!</h3>
					<h5 class="light regular light-white">Shape your body and improve your health.</h5>
					<a href="#" class="btn btn-blue ripple trial-button">Start Free Trial</a>
				</div>
				<div class="col-sm-6 text-center-mobile">
					<h3 class="white">Opening Hours <span class="open-blink"></span></h3>
					<div class="row opening-hours">
						<div class="col-sm-6 text-center-mobile">
							<h5 class="light-white light">Mon - Fri</h5>
							<h3 class="regular white">9:00 - 22:00</h3>
						</div>
						<div class="col-sm-6 text-center-mobile">
							<h5 class="light-white light">Sat - Sun</h5>
							<h3 class="regular white">10:00 - 18:00</h3>
						</div>
					</div>
				</div>
			</div>
			<div class="row bottom-footer text-center-mobile">
				<div class="col-sm-8">
					<p>&copy; 2015 All Rights Reserved. Powered by <a href="http://www.phir.co/">PHIr</a> exclusively for <a href="http://tympanus.net/codrops/">Codrops</a></p>
				</div>
				<div class="col-sm-4 text-right text-center-mobile">
					<ul class="social-footer">
						<li><a href="http://www.facebook.com/pages/Codrops/159107397912"><i class="fa fa-facebook"></i></a></li>
						<li><a href="http://www.twitter.com/codrops"><i class="fa fa-twitter"></i></a></li>
						<li><a href="https://plus.google.com/101095823814290637419"><i class="fa fa-google-plus"></i></a></li>
					</ul>
				</div>
			</div>
		</div>
	</footer>
	<!-- Holder for mobile navigation -->
	<div class="mobile-nav">
		<ul>
		</ul>
		<a href="#" class="close-link"><i class="arrow_up"></i></a>
	</div>

  <% include ../partials/scripts.ejs %>

  <script>

    //Do search on enter
    $("#inputsm").keyup(function(event){
      if(event.keyCode == 13){
        getProfessorResults();
      }
    });

    //Request the ratemyprof data from client -> server
    function getProfessorResults() {

      //Snag the text box input
      var textData = $('#inputsm').val();

      $.ajax({
          url: 'http://localhost:3000/ajaxURL',
          data: { search: textData },
          method: 'GET',
          cache: false,
          timeout: 5000,
          complete: function(data) {


              //Get the jSON results from the 'API'
              var professor_list  = data['responseJSON']['professors'];
              var link_list       = data['responseJSON']['link_data'];

              //List of all available source data for dropdown
              var availableTags   = [];

              //Results counter
              counter = 0;

              //Append the data to the textual dropdown on the homepage
              for (var i in professor_list) {
                counter++;
                availableTags.push(professor_list[i]);
              }

              //Reset the space in the box to populate all results in the dropdown
              $('#inputsm').val(textData[0]);
              $('#inputsm').attr("placeholder", counter + " results for: " + textData);

                   $("#inputsm").autocomplete({
                       source: availableTags,

                       select: function (e, ui) {
                         $("#prof_name").html(ui.item.label);


                         var prof_data_index  = $.inArray(ui.item.value, availableTags);
                         var prof_name        = professor_list[prof_data_index];
                         var prof_link        = link_list[prof_data_index];

                         console.log(prof_name);
                         console.log(prof_link);

                         scrapeProfData(prof_name, prof_link, textData);
                       }
                   });

              //Refocus the input to populate all dropdown items
              var e = jQuery.Event("keydown");
              e.which = 40;
              $('#inputsm').trigger('focus').attr('value',' ').trigger(e);
          },
          error: function(jqXHR, textStatus, errorThrown) {
              alert('Error connecting to the Node.js server... ' + textStatus + " " + errorThrown);
          }
      });
    }

    function scrapeProfData(prof_name, prof_link, textData) {
      console.log("inside scraper code");

      $.ajax({
          url: 'http://localhost:3000/getProfRatingData',
          data: { professor: prof_name, linker: prof_link, initial_query: textData },
          method: 'GET',
          cache: false,
          timeout: 5000,
          complete: function(data) {

            console.log(data);
            //Set the overall rating
            $("#overall_rating").html("Overall Rating<hr>" + data.responseJSON.rating_data[0].overall);

            //Set the helpfulness
            $("#helpfulness_rating").html(data.responseJSON.rating_data[0].helpfulness);

            //Set the clarity
            $("#clarity_rating").html(data.responseJSON.rating_data[0].clarity);

            //Set the easiness
            $("#easiness_rating").html(data.responseJSON.rating_data[0].easiness);

            $("#prof_pic").html('<img src="'+data.responseJSON.rating_data[0].picture+'" height="250" width="180">');

            helpfulnessDescription(data.responseJSON.rating_data[0].helpfulness);
            clarityDescription(data.responseJSON.rating_data[0].clarity);
            easinessDescription(data.responseJSON.rating_data[0].easiness);


            document.getElementById("click_prof").click();

          },
          error: function(jqXHR, textStatus, errorThrown) {

              alert('Error connecting to the Node.js server... ' + textStatus + " " + errorThrown);
          }
      });

    }


  function helpfulnessDescription(rating) {

    var helpfulnessDescription = ""

    if (rating <= 2) {
      helpfulnessDescription = "This rating suggests the professor is not typically helpful.. Try and pick a different one!";
      $("#helpfulness_descr").html(helpfulnessDescription);
    }
    else if (rating <= 3.8) {
      helpfulnessDescription = "This rating suggests the professor is pretty helpful! He/She is not the greatest, but it should be ok.";
      $("#helpfulness_descr").html(helpfulnessDescription);
    }
    else {
      helpfulnessDescription = "This rating suggests the professor is super helpful!! Go for it!";
      $("#helpfulness_descr").html(helpfulnessDescription);
    }
  }

  function clarityDescription(rating) {

    var clarityDescription = ""

    if (rating <= 2) {
      clarityDescription = "This rating suggests the professor is not typically clear.. Try and pick a different one!";
      $("#clarity_descr").html(clarityDescription);
    }
    else if (rating <= 3.8) {
      clarityDescription = "This rating suggests the professor is semi-clear.. You should be fine if you pay attention!";
      $("#clarity_descr").html(clarityDescription);
    }
    else {
      clarityDescription = "This rating suggests the professor is super clear! Go for it!";
      $("#clarity_descr").html(clarityDescription);
    }

  }

  function easinessDescription(rating) {

    var easinessDescription = ""

    if (rating <= 2) {
      easinessDescription = "This rating suggests the professor is not easy at all.. Try and pick a different one!";
      $("#easiness_descr").html(easinessDescription);
    }
    else if (rating <= 3.8) {
      easinessDescription = "This rating suggests the professor is semi-difficult.. You should be fine if you work hard!";
      $("#easiness_descr").html(easinessDescription);
    }
    else {
      easinessDescription = "This rating suggests the professor is super easy! Go for it!";
      $("#easiness_descr").html(easinessDescription);
    }

  }



  </script>
</body>
</html>
